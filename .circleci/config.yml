version: "2.1.0"
orbs:
    aws-ecr: circleci/aws-ecr@7.3.0
    aws-cli: circleci/aws-cli@2.0
jobs:
  configure-role-arn:
    executor: aws-cli/default
    steps:
        - checkout
        - aws-cli/setup:
            profile-name: default
        - aws-cli/role-arn-setup:
            profile-name: default
            role-arn: arn:aws:sts::695292474035:assumed-role/AWSReservedSSO_nclouds-devops_7a27a6c6e0019cb2/sachin@nclouds.com
            source-profile: default
        - run: aws sts assume-role --role-arn "arn:aws:sts::695292474035:assumed-role/AWSReservedSSO_nclouds-devops_7a27a6c6e0019cb2/sachin@nclouds.com" --role-session-name AWSCLI-Session
  
workflows:
    aws_cli:
        jobs:
           - configure-role-arn
    #build_and_push_image:
    #    jobs:
    #       - aws-ecr/build-and-push-image:
    #            repo: $repo
    #            tag: $tag
    #            requires:
    #               - aws-cli